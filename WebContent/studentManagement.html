<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<title>驾校 | 学员管理</title>

	<link rel="stylesheet" href="thirdparty/bootstrap-3.3.4-dist/css/bootstrap.min.css">
	<link rel="stylesheet" href="thirdparty/DataTables-1.10.5/media/css/dataTables.bootstrap.css">

	<link rel="stylesheet" href="css/reset.css">
	<link rel="stylesheet" href="css/main.css">
	<!-- <link rel="stylesheet" href="thirdparty/DataTables-1.10.5/media/css/jquery.dataTables.min.css"> -->
	
	
	
</head>
<body>
	 <div class="headerBar container">
		<div class="topBar">
			<div class="comWidth row">
				<div class="col-md-6 col-sm-6 " id="headerLeft">
					<a href="#" class="collection">收藏驾校圈</a>
					&nbsp|&nbsp&nbsp
					<span id="moveAble">
						<a href="login.html">[登录]</a>
						<a href="register.html">[个人免费注册]</a>
					</span>
					
				</div>
				<div class="leftArea col-md-6 col-sm-6 " style="text-align:right;" id="headerRight">
					<a href="orderList.html">[我的订单]</a>
					<a href="#kefu">[联系客服]</a>
				</div>
			</div>
		</div>
	</div>
       
      <div class="container"  >
			<div class="row logoBar" >
            	
            	<div class="col-lg-2 col-md-2 col-sm-4 col-xs-5" >
            		<a href="index.html"><img src="images/logoW.png" alt="驾校圈"></a> 
            	</div>
            	<div class="col-lg-6 col-md-6 col-sm-6 col-xs-7" >
            		<div class="input-group search_box">
                        <input type="text" class="form-control" placeholder="驾校团购信息或学校" id="keyword">
                        <span class="input-group-btn">
                            <button class="btn btn-default search_btn" type="button"><span class="text-success">搜索</span></button>
                        </span>
                    </div>
				</div>
				<div class="col-lg-4 col-md-4 col-sm-4"></div>
            		
        	</div>
        </div> 
	
	<hr>

	<div class="container">
		
		

        <!-- Marketing Icons Section -->
        <div class="row">
            <div class="col-lg-12">
                <h1 class="page-header">
                    欢迎您<span id="jx_name"></span>!
                    <small>学员预约查看/管理</small>
                </h1>
            </div>

          	<div class="col-lg-12">  
				<div id="table_area">
					<table id="example" class="display table table-striped table-bordered" cellspacing="0" width="100%">
						<thead>
							<tr>
								<th>联系人姓名</th>
								<th>联系电话</th>
								<th>预约时间</th>
								<th>本地人数</th>
								<th>异地人数</th>
								<th>是否完成预约</th>
							</tr>
						</thead>

						<tfoot>
							<tr>
								<th>联系人姓名</th>
								<th>联系电话</th>
								<th>预约时间</th>
								<th>本地人数</th>
								<th>异地人数</th>
								<th>是否完成预约</th>
							</tr>
						</tfoot>
					</table>
				</div>
			</div>


		</div>

		<div class="row">
            <div class="col-md-8">
                <h2 class="page-header">
                    确认预约
                </h2>
                <form name="confirm" id="confirm" action="check.ds" method="post" novalidate>
                    <div class="control-group form-group">
                        <div class="controls">
                            <label>学员姓名:</label>
                            <input type="text" class="form-control" name="name" id="name" required data-validation-required-message="Please enter your name.">
                            <p class="help-block"></p>
                        </div>
                    </div>
                    <div class="control-group form-group">
                        <div class="controls">
                            <label>学员手机号:</label>
                            <input type="tel" class="form-control" name="phone" id="phone" required data-validation-required-message="Please enter your phone number.">
                        </div>
                    </div>
                    <div class="control-group form-group">
                        <div class="controls">
                            <label>学员预约号:</label>
                            <input type="text" class="form-control" name="checknumber" id="checknumber" required data-validation-required-message="Please enter your checknumber.">
                        </div>
                    </div>
                    
                    
                    
                    <div id="success"></div>
                    <!-- For success/fail messages -->
                    <button type="button" id="check" class="btn btn-primary">确认预约</button>
                </form>
            </div>

        </div>
        <!-- /.row -->

	</div>

	<div class="footer">
		<p><a href="#">驾校圈简介</a><i>|</i><a href="#">驾校圈公告</a><i>|</i> <a href="#">招纳贤士</a><i>|</i><a href="#">联系我们</a><i>|</i>客服热线：400-675-1234</p>
	<p>Copyright &copy; 2014 - 2015 驾校圈版权所有&nbsp;&nbsp;&nbsp;京ICP备09037834号&nbsp;&nbsp;&nbsp;京ICP证B1034-8373号&nbsp;&nbsp;&nbsp;某市公安局XX分局备案编号：123456789123</p>

	<script src="thirdparty/jquery/jquery-1.11.0.js"></script>
	<script src="thirdparty/DataTables-1.10.5/media/js/jquery.dataTables.js"></script>
	<script src="thirdparty/DataTables-1.10.5/media/js/dataTables.bootstrap.js"></script>
	<script src="js/jqBootstrapValidation.js"></script>
	<script src="js/user.js"></script>
	<script>
		$(document).ready(function() {
			var selected = [];
			var jx = JSON.parse(sessionStorage.getItem('jx'));
			
			if(!jx){
				return;
			}
			
			$('#jx_name').text(jx.name);
			$('#example').dataTable( {
				"ajax": {
					"url": "getOrdersInfo.ds?phone="+jx.mobile+"&jxpwd="+jx.password,
					"dataSrc": function(json){
						return json;
					} 
				},
				"columns": [
					{ "data": "name" },
					{ "data": "phone" },
					{ "data": "order_time" },
					{ "data": "local" },
					{ "data": "notLocal" },
					{ "data": "checked" }
				],
				 "createdRow": function( row, data, dataIndex ) {
				    if ( data.checked == '是' ) {
				      $(row).addClass( 'success' );
				    } else{
				    	$(row).addClass( 'warning' );
				    }
				  }
			} );

			$('#check').click(function(){
				$(this).prop("disabled",true);
				
				
				var data ={
						name: $('#name').val().trim(),
						phone: $('#phone').val().trim(),
						checknumber: $('#checknumber').val().trim(),
						jxmobile: jx.mobile,
						jxpassword: jx.password
				}
				
				$.ajax({
					url:"check.ds",
					method:"post",
					dataType: "json",
					data: data,
					success: successCallback,
					error: errorCallback
				});
				var that = $(this);
				function successCallback(data){
					alert(data.msg);
					that.prop("disabled",false);
					
					if(data.success){
						location.reload();
					}else{
						
					}
					
				}
				function errorCallback(data){
					alert("服务器错误,请联系管理员！");
					that.prop("disabled",false);
				}
			});
			
		} );
	</script>
</body>
</html>